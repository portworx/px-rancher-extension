(("undefined"!==typeof self?self:this)["webpackChunkportworx_1_0_0_7c0e179"]=("undefined"!==typeof self?self:this)["webpackChunkportworx_1_0_0_7c0e179"]||[]).push([[437],{6877:function(e,t,l){"use strict";l.r(t);var a=l(429),o=l.n(a),r=l(1214),n=l.n(r),s=n()(o());s.push([e.id,"H5[data-v-f30cbb7e]{opacity:.8;font-size:14px}",""]),t["default"]=s},6060:function(e,t,l){"use strict";l.r(t);var a=l(429),o=l.n(a),r=l(1214),n=l.n(r),s=n()(o());s.push([e.id,".badge-state[data-v-ddeb1b10]{align-items:center;display:inline-flex;padding:2px 10px;border:1px solid transparent;border-radius:20px}.badge-state.bg-info[data-v-ddeb1b10]{border-color:var(--info)}.badge-state.bg-error[data-v-ddeb1b10]{border-color:var(--error)}.badge-state.bg-warning[data-v-ddeb1b10]{border-color:var(--warning)}.badge-state.bg-success[data-v-ddeb1b10]{color:var(--success);background:transparent;border-color:var(--success)}",""]),t["default"]=s},5718:function(e,t,l){"use strict";l.r(t);var a=l(429),o=l.n(a),r=l(1214),n=l.n(r),s=n()(o());s.push([e.id,".sortable-table TD .badge-state{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;word-wrap:break-word;display:inline-block;max-width:100%;position:relative;max-width:110px;font-size:.85em;vertical-align:middle}",""]),t["default"]=s},437:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return ee}});var a=l(9274);const o=e=>((0,a.pushScopeId)("data-v-f30cbb7e"),e=e(),(0,a.popScopeId)(),e),r=o((()=>(0,a.createElementVNode)("div",{class:"tab-header"},[(0,a.createElementVNode)("h2",null,"Portworx Details")],-1))),n={key:0,style:{display:"flex","justify-content":"center","align-items":"center",height:"60vh"}},s={key:1,id:"banner-px-not-installed",style:{"margin-top":"1rem"}},c=["href"],i={key:2},d={style:{display:"flex","margin-top":"1.5rem"}},m={id:"pvc-details-left",style:{display:"flex","flex-direction":"column",width:"50%","padding-right":"15px"}},u={style:{"margin-bottom":"1.5rem"}},p=o((()=>(0,a.createElementVNode)("h4",null,"Name",-1))),h={style:{"margin-bottom":"1.5rem"}},g=o((()=>(0,a.createElementVNode)("h4",null,"Status",-1))),v={style:{"margin-bottom":"1.5rem"}},b=o((()=>(0,a.createElementVNode)("h4",null,"Replication Factor",-1))),f={style:{"margin-bottom":"1.5rem"}},y=o((()=>(0,a.createElementVNode)("h4",null,"Labels",-1))),N={key:0,style:{display:"flex","flex-wrap":"wrap",gap:"5px"}},E={key:1},k={id:"pvc-details-left",style:{display:"flex","flex-direction":"column",width:"50%","padding-left":"15px"}},x={style:{"margin-bottom":"1.5rem"}},V=o((()=>(0,a.createElementVNode)("h4",null,"Size",-1))),w={style:{"margin-bottom":"1.5rem"}},B=o((()=>(0,a.createElementVNode)("h4",null,"Format",-1))),S={style:{"margin-bottom":"1.5rem"}},_=o((()=>(0,a.createElementVNode)("h4",null,"Replicas on Nodes",-1))),C={key:0},D={key:1},I={style:{"margin-bottom":"1.5rem"}},P=o((()=>(0,a.createElementVNode)("h4",null,"Attached Node",-1))),A={style:{"margin-bottom":"1.5rem"}},T=o((()=>(0,a.createElementVNode)("h4",null,"Storage Class",-1))),L={key:0},F=o((()=>(0,a.createElementVNode)("h3",null,"Volume Consumers",-1))),R={key:0,style:{"max-height":"300px","overflow-y":"auto"}},$={key:1};function M(e,t,l,o,M,O){const z=(0,a.resolveComponent)("Banner"),U=(0,a.resolveComponent)("BadgeState"),X=(0,a.resolveComponent)("router-link"),j=(0,a.resolveComponent)("ResourceTable");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[r,M.isInitDataFetching?((0,a.openBlock)(),(0,a.createElementBlock)("div",n," Loading... ")):M.isInitDataFetching||"none"===M.pageError?((0,a.openBlock)(),(0,a.createElementBlock)("div",i,[(0,a.createElementVNode)("div",d,[(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",u,[p,(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(M.selfPvc?.metadata?.name||"-"),1)]),(0,a.createElementVNode)("div",h,[g,(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(M.selfPvc?.status?.phase||"-"),1)]),(0,a.createElementVNode)("div",v,[b,(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(M.volume?.labels?.repl||"-"),1)]),(0,a.createElementVNode)("div",f,[y,M.labels?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",N,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(M.labels,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t},[(0,a.createVNode)(U,{color:"bg-info",label:e},null,8,["label"])])))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("h5",E," - "))])]),(0,a.createElementVNode)("div",k,[(0,a.createElementVNode)("div",x,[V,(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(M.selfPvc?.spec?.resources?.requests?.storage||"-"),1)]),(0,a.createElementVNode)("div",w,[B,(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(M.volume?.volume?.format?.split("_")[2]||"-"),1)]),(0,a.createElementVNode)("div",S,[_,(0,a.createElementVNode)("h5",null,[M.replicaNodes?.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",C,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(M.replicaNodes,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t}," Node: "+(0,a.toDisplayString)(e?.data_ip||"-"),1)))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)("div",D," - "))])]),(0,a.createElementVNode)("div",I,[P,(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(M.volume?.volume?.attached_on||"-"),1)]),(0,a.createElementVNode)("div",A,[T,(0,a.createElementVNode)("div",null,[M.selfPvc?.spec?.storageClassName&&"Use the default class"!==M.selfPvc?.spec?.storageClassName?((0,a.openBlock)(),(0,a.createBlock)(X,{key:1,to:O.getStorageClassLink(M.selfPvc?.spec?.storageClassName)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(M.selfPvc?.spec?.storageClassName),1)])),_:1},8,["to"])):((0,a.openBlock)(),(0,a.createElementBlock)("h5",L,(0,a.toDisplayString)(M.selfPvc?.spec?.storageClassName||"-"),1))])])])]),(0,a.createElementVNode)("div",null,[F,(0,a.createElementVNode)("div",null,[M.volume?.volume?.volume_consumers?.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",R,[(0,a.createVNode)(j,{"data-testid":"volume-consumers-sortable-table",rows:M.volume.volume.volume_consumers,headers:M.CONSUMERS_HEADERS,"table-actions":!1,"row-actions":!1,search:!1},{"col:name":(0,a.withCtx)((({row:e})=>[(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.name?.split("(")[0]||"-"),1)])])),"col:namespace":(0,a.withCtx)((({row:e})=>[(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.namespace||"-"),1)])])),"col:runningOn":(0,a.withCtx)((({row:e})=>[(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e?.node_id||""),1)])])),"col:controlledBy":(0,a.withCtx)((({row:e})=>[(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e?.owner_name),1)])])),_:1},8,["rows","headers"])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",$,[(0,a.createVNode)(z,{class:"type-banner mb-20 mt-0",color:"info",label:M.isInitDataFetching?"Loading volume consumers...":"No volume consumers found."},null,8,["label"])]))])])])):((0,a.openBlock)(),(0,a.createElementBlock)("div",s,["px-not-installed"===M.pageError?((0,a.openBlock)(),(0,a.createBlock)(z,{key:0,class:"type-banner mb-20 mt-0",color:"warning"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" Portworx is not installed on this cluster. Click "),(0,a.createElementVNode)("a",{style:{cursor:"pointer"},href:M.EXTERNAL_LINKS.INSTALL_PX,target:"_blank"},"here",8,c),(0,a.createTextVNode)(" to learn how to install Portworx. ")])),_:1})):"failed-fetching-services"===M.pageError?((0,a.openBlock)(),(0,a.createBlock)(z,{key:1,class:"type-banner mb-20 mt-0",color:"error"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" Unable to fetch services for the cluster. Please try again later. ")])),_:1})):"px-secure-cluster"===M.pageError?((0,a.openBlock)(),(0,a.createBlock)(z,{key:2,class:"type-banner mb-20 mt-0",color:"warning"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" Portworx extension is currently not supported for PX-Security enabled clusters. ")])),_:1})):"failed-fetching-cluster"===M.pageError?((0,a.openBlock)(),(0,a.createBlock)(z,{key:3,class:"type-banner mb-20 mt-0",color:"error"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)(" Unable to retrieve storage cluster details. Please try again later. ")])),_:1})):(0,a.createCommentVNode)("",!0)]))])}function O(e,t,l,o,r,n){return(0,a.openBlock)(),(0,a.createElementBlock)("span",{class:(0,a.normalizeClass)(["badge-state",e.bg])},[e.icon?((0,a.openBlock)(),(0,a.createElementBlock)("i",{key:0,class:(0,a.normalizeClass)(["icon",{[e.icon]:!0,"mr-5":!!e.msg}])},null,2)):(0,a.createCommentVNode)("",!0),(0,a.createTextVNode)((0,a.toDisplayString)(e.msg),1)],2)}var z=(0,a.defineComponent)({props:{value:{type:Object,default:null},color:{type:String,default:null},icon:{type:String,default:null},label:{type:String,default:null}},computed:{bg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateBackground)||this.color},msg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateDisplay)||this.label}}}),U=(l(5596),l(3622),l(7433));const X=(0,U.A)(z,[["render",O],["__scopeId","data-v-ddeb1b10"]]);var j=X,H=l(4850),K=l(3060),q=l(6214),G=l(9485),J=l(5752);const Q=[{name:"name",value:"name",label:"Name",sort:"name"},{name:"namespace",value:"namespace",label:"Namespace",sort:"namespace"},{name:"runningOn",value:"runningOn",label:"Running On",sort:"runningOn"},{name:"controlledBy",value:"controlledBy",label:"Controlled By",sort:"controlledBy"}];var W=l(4364),Y={name:"PVCPortworxDetails",components:{BadgeState:j,Banner:H.l,ResourceTable:K.A},data(){return{isInitDataFetching:!0,pageError:"none",pxInstalledNS:"",selfPvc:{},volume:{},replicaNodes:[],labels:[],pxSecureAuthToken:"",cluster:{},CONSUMERS_HEADERS:Q,EXTERNAL_LINKS:q.m}},methods:{async fetchData(){this.EXTERNAL_LINKS=q.m,this.isInitDataFetching=!0,this.selfPvc=this.$attrs.resource;try{const e=this.$route.params.cluster;if([this.pxInstalledNS,this.pageError]=await J.A.methods.getPortworxNamespace(e),"none"!==this.pageError)return void(this.isInitDataFetching=!1);if([this.cluster,this.pxSecureAuthToken,this.pageError]=await J.A.methods.getStorageClusterDetails(e,this.pxInstalledNS),"none"!==this.pageError)return void(this.isInitDataFetching=!1);const t={};this.pxSecureAuthToken&&(t.headers={Authorization:`Bearer ${this.pxSecureAuthToken}`});const l=await this.$axios.post(G.S.pxFilterVolumes(this.$route.params.cluster,this.pxInstalledNS),{name:this.selfPvc?.spec?.volumeName,options:{deep:!0}},t).then((e=>e)).catch((e=>(403===e.response.status&&(this.pageError="px-secure-cluster"),{})));if(this.volume=(l?.data?.volumes||[])[0],this.getLabels(),l?.data?.volumes&&this.volume?.volume?.replica_sets){const e=[];this.volume.volume.replica_sets.forEach((t=>{e.push(...t?.nodes||[])})),this.replicaNodes=await this.getNodeSummary(e,t)}this.isInitDataFetching=!1}catch(e){this.isInitDataFetching=!1}},async getNodeSummary(e,t){try{const l=await Promise.allSettled(e.map((async e=>{const l=await this.$axios.get(G.S.pxNodeInspectApi(this.$route.params.cluster,e,this.pxInstalledNS),t);return l.data.node}))).then((e=>e)).catch((e=>(403===e.response.status&&(this.pageError="px-secure-cluster"),{})));return l.filter((e=>"fulfilled"===e.status)).map((e=>e.value))}catch(l){throw W.error("Error in getting nodes"),l}},getStorageClassLink(e){return`/c/${this.$route.params.cluster}/explorer/storage.k8s.io.storageclass/${e}#parameters`},getLabels(){this.labels=[],this.volume?.labels&&Object.keys(this.volume.labels).forEach((e=>{this.labels.push(`${e}: ${this.volume.labels[e]}`)}))}},created(){this.fetchData()}};l(2624);const Z=(0,U.A)(Y,[["render",M],["__scopeId","data-v-f30cbb7e"]]);var ee=Z},2624:function(e,t,l){var a=l(6877);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=l(4825).A;o("3bbd1db0",a,!0,{sourceMap:!1,shadowMode:!1})},5596:function(e,t,l){var a=l(6060);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=l(4825).A;o("7c01a71f",a,!0,{sourceMap:!1,shadowMode:!1})},3622:function(e,t,l){var a=l(5718);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var o=l(4825).A;o("9fad3f9a",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=portworx-1.0.0-7c0e179.umd.min.437.js.map
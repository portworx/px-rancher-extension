(("undefined"!==typeof self?self:this)["webpackJsonpportworx_0_1_5_rc9_f654a07"]=("undefined"!==typeof self?self:this)["webpackJsonpportworx_0_1_5_rc9_f654a07"]||[]).push([[1],{"3bb5":function(e,t,a){var s=a("830d");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var l=a("0ed3").default;l("e7c745b8",s,!0,{sourceMap:!1,shadowMode:!1})},"5eb8":function(e,t,a){var s=a("96fa");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var l=a("0ed3").default;l("0d40dbfe",s,!0,{sourceMap:!1,shadowMode:!1})},6136:function(e,t,a){"use strict";a("929c")},"819e":function(e,t,a){"use strict";a("5eb8")},"830d":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".badge-state[data-v-70e48e16]{align-items:center;display:inline-flex;padding:2px 10px;border:1px solid transparent;border-radius:20px}.badge-state.bg-info[data-v-70e48e16]{border-color:var(--primary)}.badge-state.bg-error[data-v-70e48e16]{border-color:var(--error)}.badge-state.bg-warning[data-v-70e48e16]{border-color:var(--warning)}.badge-state.bg-success[data-v-70e48e16]{color:var(--success);background:transparent;border-color:var(--success)}",""]),e.exports=t},"929c":function(e,t,a){var s=a("cc73");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var l=a("0ed3").default;l("ee5b084c",s,!0,{sourceMap:!1,shadowMode:!1})},"96fa":function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,"H5[data-v-f30cbb7e]{opacity:.8;font-size:14px}",""]),e.exports=t},cc73:function(e,t,a){var s=a("5eaa");t=s(!1),t.push([e.i,".sortable-table TD .badge-state{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;word-wrap:break-word;display:inline-block;max-width:100%;position:relative;max-width:110px;font-size:.85em;vertical-align:middle}",""]),e.exports=t},d1d7:function(e,t,a){"use strict";a.r(t);var s=function(){var e,t,a,s,l,o,r,i,n,d,c,u,v,p,h=this,m=h._self._c;return m("div",[h._m(0),h.isInitDataFetching?m("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"60vh"}},[h._v(" Loading... ")]):h.isInitDataFetching||"none"===h.pageError?m("div",[m("div",{staticStyle:{display:"flex","margin-top":"1.5rem"}},[m("div",{staticStyle:{display:"flex","flex-direction":"column",width:"50%","padding-right":"15px"},attrs:{id:"pvc-details-left"}},[m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Name")]),m("h5",[h._v(h._s((null===(e=h.selfPvc)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.name)||"-"))])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Status")]),m("h5",[h._v(h._s((null===(t=h.selfPvc)||void 0===t||null===(t=t.status)||void 0===t?void 0:t.phase)||"-"))])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Replication Factor")]),m("h5",[h._v(h._s((null===(a=h.volume)||void 0===a||null===(a=a.labels)||void 0===a?void 0:a.repl)||"-"))])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Labels")]),null!==(s=h.labels)&&void 0!==s&&s.length?m("div",{staticStyle:{display:"flex","flex-wrap":"wrap",gap:"5px"}},h._l(h.labels,(function(e,t){return m("div",{key:t},[m("BadgeState",{attrs:{color:"bg-info",label:e}})],1)})),0):m("h5",[h._v(" - ")])])]),m("div",{staticStyle:{display:"flex","flex-direction":"column",width:"50%","padding-left":"15px"},attrs:{id:"pvc-details-left"}},[m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Size")]),m("h5",[h._v(h._s((null===(l=h.selfPvc)||void 0===l||null===(l=l.spec)||void 0===l||null===(l=l.resources)||void 0===l||null===(l=l.requests)||void 0===l?void 0:l.storage)||"-"))])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Format")]),m("h5",[h._v(h._s((null===(o=h.volume)||void 0===o||null===(o=o.volume)||void 0===o||null===(o=o.format)||void 0===o?void 0:o.split("_")[2])||"-"))])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Replicas on Nodes")]),m("h5",[(null===(r=h.replicaNodes)||void 0===r?void 0:r.length)>0?m("div",h._l(h.replicaNodes,(function(e,t){return m("div",{key:t},[h._v(" Node: "+h._s((null===e||void 0===e?void 0:e.data_ip)||"-")+" ")])})),0):m("div",[h._v(" - ")])])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Attached Node")]),m("h5",[h._v(h._s((null===(i=h.volume)||void 0===i||null===(i=i.volume)||void 0===i?void 0:i.attached_on)||"-"))])]),m("div",{staticStyle:{"margin-bottom":"1.5rem"}},[m("h4",[h._v("Storage Class")]),m("div",[null!==(n=h.selfPvc)&&void 0!==n&&null!==(n=n.spec)&&void 0!==n&&n.storageClassName&&"Use the default class"!==(null===(d=h.selfPvc)||void 0===d||null===(d=d.spec)||void 0===d?void 0:d.storageClassName)?m("router-link",{attrs:{to:h.getStorageClassLink(null===(u=h.selfPvc)||void 0===u||null===(u=u.spec)||void 0===u?void 0:u.storageClassName)}},[h._v(" "+h._s(null===(v=h.selfPvc)||void 0===v||null===(v=v.spec)||void 0===v?void 0:v.storageClassName)+" ")]):m("h5",[h._v(h._s((null===(c=h.selfPvc)||void 0===c||null===(c=c.spec)||void 0===c?void 0:c.storageClassName)||"-"))])],1)])])]),m("div",[m("h3",[h._v("Volume Consumers")]),m("div",[null!==(p=h.volume)&&void 0!==p&&null!==(p=p.volume)&&void 0!==p&&null!==(p=p.volume_consumers)&&void 0!==p&&p.length?m("div",{staticStyle:{"max-height":"300px","overflow-y":"auto"}},[m("ResourceTable",{attrs:{"data-testid":"volume-consumers-sortable-table",rows:h.volume.volume.volume_consumers,headers:h.CONSUMERS_HEADERS,"table-actions":!1,"row-actions":!1,search:!1},scopedSlots:h._u([{key:"col:name",fn:function({row:e}){var t;return[m("td",[m("span",[h._v(h._s((null===(t=e.name)||void 0===t?void 0:t.split("(")[0])||"-"))])])]}},{key:"col:namespace",fn:function({row:e}){return[m("td",[m("span",[h._v(h._s(e.namespace||"-"))])])]}},{key:"col:runningOn",fn:function({row:e}){return[m("td",[m("span",[h._v(h._s((null===e||void 0===e?void 0:e.node_id)||""))])])]}},{key:"col:controlledBy",fn:function({row:e}){return[m("td",[m("span",[h._v(h._s(null===e||void 0===e?void 0:e.owner_name))])])]}}],null,!1,3769646089)})],1):m("div",[m("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"info",label:h.isInitDataFetching?"Loading volume consumers...":"No volume consumers found."}})],1)])])]):m("div",{staticStyle:{"margin-top":"1rem"},attrs:{id:"banner-px-not-installed"}},["px-not-installed"===h.pageError?m("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"warning"}},[h._v(" Portworx is not installed on this cluster. Click "),m("a",{staticStyle:{cursor:"pointer"},attrs:{href:h.EXTERNAL_LINKS.INSTALL_PX,target:"_blank"}},[h._v("here")]),h._v(" to learn how to install Portworx. ")]):"failed-fetching-services"===h.pageError?m("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"error"}},[h._v(" Unable to fetch services for the cluster. Please try again later. ")]):"px-secure-cluster"===h.pageError?m("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"warning"}},[h._v(" Portworx extension is currently not supported for PX-Security enabled clusters. ")]):"failed-fetching-cluster"===h.pageError?m("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"error"}},[h._v(" Unable to retrieve storage cluster details. Please try again later. ")]):h._e()],1)])},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",[e._v("Portworx Details")])])}],o=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("span",{class:{"badge-state":!0,[e.bg]:!0}},[e.icon?t("i",{staticClass:"icon",class:{[e.icon]:!0,"mr-5":!!e.msg}}):e._e(),e._v(e._s(e.msg)+" ")])},r=[],i=a("8bbf"),n=a.n(i),d=n.a.extend({props:{value:{type:Object,default:null},color:{type:String,default:null},icon:{type:String,default:null},label:{type:String,default:null}},computed:{bg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateBackground)||this.color},msg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateDisplay)||this.label}}}),c=d,u=(a("d255"),a("6136"),a("d802")),v=Object(u["a"])(c,o,r,!1,null,"70e48e16",null),p=v.exports,h=a("6418"),m=a("126f"),f=a("377f"),g=a("ae9f"),b=a("2e43");const _=[{name:"name",value:"name",label:"Name",sort:"name"},{name:"namespace",value:"namespace",label:"Namespace",sort:"namespace"},{name:"runningOn",value:"runningOn",label:"Running On",sort:"runningOn"},{name:"controlledBy",value:"controlledBy",label:"Controlled By",sort:"controlledBy"}];var y={name:"PVCPortworxDetails",components:{BadgeState:p,Banner:h["a"],ResourceTable:m["a"]},data(){return{isInitDataFetching:!0,pageError:"none",pxInstalledNS:"",selfPvc:{},volume:{},replicaNodes:[],labels:[],pxSecureAuthToken:"",cluster:{},CONSUMERS_HEADERS:_,EXTERNAL_LINKS:f["a"]}},methods:{async fetchData(){this.EXTERNAL_LINKS=f["a"],this.isInitDataFetching=!0,this.selfPvc=this.$attrs.resource;try{var e,t,a,s;const l=this.$route.params.cluster;if([this.pxInstalledNS,this.pageError]=await b["a"].methods.getPortworxNamespace(l),"none"!==this.pageError)return void(this.isInitDataFetching=!1);if([this.cluster,this.pxSecureAuthToken,this.pageError]=await b["a"].methods.getStorageClusterDetails(l,this.pxInstalledNS),"none"!==this.pageError)return void(this.isInitDataFetching=!1);const o={};this.pxSecureAuthToken&&(o.headers={Authorization:"Bearer "+this.pxSecureAuthToken});const r=await this.$axios.post(g["a"].pxFilterVolumes(this.$route.params.cluster,this.pxInstalledNS),{name:null===(e=this.selfPvc)||void 0===e||null===(e=e.spec)||void 0===e?void 0:e.volumeName,options:{deep:!0}},o).then(e=>e).catch(e=>(403===e.response.status&&(this.pageError="px-secure-cluster"),{}));if(this.volume=((null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.volumes)||[])[0],this.getLabels(),null!==r&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.volumes&&null!==(s=this.volume)&&void 0!==s&&null!==(s=s.volume)&&void 0!==s&&s.replica_sets){const e=[];this.volume.volume.replica_sets.forEach(t=>{e.push(...(null===t||void 0===t?void 0:t.nodes)||[])}),this.replicaNodes=await this.getNodeSummary(e,o)}this.isInitDataFetching=!1}catch(l){this.isInitDataFetching=!1}},async getNodeSummary(e,t){try{const a=await Promise.allSettled(e.map(async e=>{const a=await this.$axios.get(g["a"].pxNodeInspectApi(this.$route.params.cluster,e,this.pxInstalledNS),t);return a.data.node})).then(e=>e).catch(e=>(403===e.response.status&&(this.pageError="px-secure-cluster"),{}));return a.filter(e=>"fulfilled"===e.status).map(e=>e.value)}catch(a){throw console.error("Error in getting nodes"),a}},getStorageClassLink(e){return`/c/${this.$route.params.cluster}/explorer/storage.k8s.io.storageclass/${e}#parameters`},getLabels(){var e;this.labels=[],null!==(e=this.volume)&&void 0!==e&&e.labels&&Object.keys(this.volume.labels).forEach(e=>{this.labels.push(`${e}: ${this.volume.labels[e]}`)})}},created(){this.fetchData()}},x=y,S=(a("819e"),Object(u["a"])(x,s,l,!1,null,"f30cbb7e",null));t["default"]=S.exports},d255:function(e,t,a){"use strict";a("3bb5")}}]);
//# sourceMappingURL=portworx-0.1.5-rc9-f654a07.umd.min.1.js.map